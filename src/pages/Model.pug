extends ../templates/contents.pug

block headVars
    - var title = "Model"
    - var requireMathJax = true

block article
    :markdown-it(html)

        Mathematical models allow us to gain an insight into the functioning of a system and 
        also allow us to hypothesise, predict and verify its behaviour. Formulating a model therefore, 
        provides a mathematical validation of the system created.  Considering our restricted and later 
        on non-existent access to a laboratory environment due to COVID-19, these models are the cornerstone 
        of our project — they lend it legitimacy and validity in the absence of experimental proofs. 
        Our project consists of four individual models which collectively complete our project. These would be discussed in the following sections. 
        
        (We also enlisted the help of the majestic Deep Thought to formulate our models, but forty-two was a rather difficult model to realise without any help from pan-dimensional, hyper-intelligent beings.)

        # Growth Curve

        Before we proceeded with the specifics of our project such as the genetic design and such, it was imperative to show that 
        our specimen — *Escherichia coli*, was able to replicate and survive in the sugarcane system, at least long enough to serve 
        its purpose (Nietzsche is proud, maybe). Fortunately, the experiments required to support these claims could be performed in 
        a laboratory setting. As it would have been rather difficult to measure the growth of *E. coli* directly in the sugarcane matrix, 
        we extracted the juice from a sugarcane plant and cultured our bacterium in this medium and performed optical density (OD at 600nm) 
        measurements on the liquid at regular intervals of one hour. These readings were taken thrice and the averages of the three are tabulated below.


    :markdown-it(html plugins=['markdown-it-multimd-table'])
        | **Time Elapsed** (h)      | **Optical Density** (at 600nm)     | 
        | :-----------:  | :-----------: |
        | 1            | 0.001         |
        | 2            | 0.019         |
        | 3            | 0.050         |                                              
        | 4            | 0.042         |
        | 5            | 0.049         |
        | 6            | 0.059         |
        | 7            | 0.095         |
        | 8            | 0.072         |
        
        [Table 1: Optical density of the culture at 600nm at different times]

    - var imgpath = "" + require("../assets/img/Model--ODScatterPlot.png")["default"]
    +image(1, imgpath, "A scatterplot showing the variation of OD versus time")

    :markdown-it(html)

        The optical density was subsequently converted to population size (in the units cfu/mL) using the conversion
        ratio 1 OD = \\( 10^{-6} \\) cfu/mL. Then, the data was converted to the semi log domain by calculating the log (base 10) of
        the OD while retaining the time series as it is. 

        We selected a simple logistic equation to model the growth of the bacteria. At this moment, we would also like to state that
        other models — like Gompertz, Stannerd or Richards exist [Zwietering et. al, 1990](#citation1), but we felt that a logistic model best suited our data and purpose. 

        ## Logistic Model

        Developed in 1838 by Belgian mathematician Pierre  François Verhulst, a logistic model makes the assumption that the rate of population 
        growth is limited and is dependent on the size of the population at any particular instant of time. Specifically, the rate of growth \\( r \\) is equal to

        $$
            r = r_0\left(1 - \frac{N}{N_{\text{max}}}\right)
        $$

        Since the rate of population growth is directly proportional to the population size at that given time [Verhulst, 1838](#citation2), we obtain the differential 
        equation governing the growth.

        $$
            \frac{dN}{dt} = rN
        $$

        $$
            \frac{dN}{dt} = r_0 N \left(1 - \frac{N}{N_{\text{max}}}\right)
        $$

        Here, \\( r_0 \\) is the maximum possible rate of population growth and \\( N_{\text{max}} \\) is the carrying capacity of the medium. 
        Solving the above ODE, we obtain the following closed-form solution for the population size as a function of time

        $$
            N(t) = \frac{N_0N_{\text{max}}}{N_0 + (N_{\text{max}} - N_0)\cdot exp(-r_0 t)}
        $$
    :markdown-it(html)
        We initially solve the ODE using SciPy's `solve_ivp` method with an initial guess of the parameter \\( r_0 \\) set to 1. 
        We do not consider the carrying capacity \\( N_{\text{max}} \\) to be a variable parameter and set it to \\( 1 + 10^{-6} \\) times the maximum 
        population size in the data series.

        Once a solution is obtained with these parameter values, we run an optimiser using SciPy's `minimize` method to modify the values of the parameter \\( r_0 \\) 
        to minimise the least-squares sum between the predictions and the actual population size (this serves as the cost function).
        When a minimum value for the parameter \\( r_0 \\) is obtained, we plot the final curve. Fitting the data to our curve, we obtain the growth function

        $$
            N(t) = \frac{4.9777}{1 + 0.6592\cdot exp(-1.2017t)}
        $$

    - var imgpath = "" + require("../assets/img/Model--GrowthPrediction.png")["default"]
    +image(2, imgpath, "A graph of the function that models bacterial growth in the sugarcane.")

    :markdown-it(html)
        With this model, we have proved that our organism is able to survive and replicate within the sugarcane matrix with a nontrivial growth rate and 
        reaches a sufficiently large population size.

        The codebase for this model can be found [here](https://github.com/igembitsgoa/modelling).

        # Proposed Implementation Models

        The models in this section provide mathematical validation to the proposed implementation of our project. The models listed below are the viscosity model
        (for the inoculant) and a docking model.

        ## Viscosity model
        In this model, we aim to determine the optimum kinematic viscosity (also known as "momentum diffusivity", is equal to the ratio of the viscosity to the density of the fluid)
        of the polymer-based liquid inoculant suspension of the bacteria that is introduced into the plant system. Furthermore, we would also like to prove that this inoculant is 
        transported throughout the plant system by the vascular bundle. Henceforth, we shall be using the term ‘viscosity’ to refer to the kinematic viscosity of the liquid, unless stated otherwise.

        To allow for the inoculant to be viscous enough for viable vascular transport, we make the assumption that its viscosity lies between certain permissible values. The viscosity is assumed to lie
        within a certain interval from the kinematic viscosity of water. Let \\( \sigma \\) represent this range and \\( \nu_w \\) represent the viscosity of water, then the viscosity of the inoculant, 
        \\( \nu \\), lies within the range

        $$
            \nu_w - \sigma \leq \nu \leq \nu_w + \sigma
        $$

        Suppose our polymer-based inoculant consists of \\( N \\) components, we can determine the Viscosity Blending Number (VBN) of each component [Refutas, 2000](#citation3). The VBN of a particular solvent with 
        viscosity \\( \nu_i \\) is

        $$
            \text{VBN}_i = 14.534\cdot\ln(\ln(\nu_i + 0.8)) + 10.975
        $$

        The VBN of the N-component solvent is then calculated as

        $$
            \text{VBN} = \sum_{i=1}^{N} \chi_i \cdot \text{VBN}_i
        $$

        Where \\( \chi_i \\) is the mass fraction of each component. Given the VBN of the mixture, the viscosity can be calculated as:
        $$
            \nu = \exp\left(\exp\left(\frac{\text{VBN} - 10.975}{14.534}\right)\right) - 0.8
        $$

        Imposing the assumption we made about the viscosity of the inoculant, we obtain the following constraint on the viscosity:

        $$
            14.534\ln(\ln(\nu_w + 0.8 -\sigma)) + 10.975 \leq \sum_{i = 1}^{N} \chi_i \cdot \text{VBN}_i \leq 14.534\ln(\ln(\nu_w + 0.8 +\sigma)) \\
            + 10.975
        $$
        
        If we use the toxicity of the inoculant as a cost function (a reasonable choice as the inoculant is going to be introduced into a food product), we can then set up a linear progamming problem
        to determine the viscosity of the inoculant. Using the LD50 (Rat, oral) values for each component (reprented by \\(T_i\\)), we set up the cost function 
        $$
            C =  \sum_{i=1}^{N} \chi_i \cdot T_i
        $$

        The term \\( \sigma \\) was set to 15% of the viscosity of water.

        We now state the components of the inoculant: Luria-Bertani Broth, Carboxymethyl cellulose (CMC), Bentonite, Triton X 100, Sorbic Acid, and Potassium Sorbate. These components were used for their 
        low toxicity and relative ease of availability (cite). Another reason for choosing these set of components was that they can easily be removed from the juice during its processing by methods that are already used in
        the sugar manufacturing process. To look at a detailed description of the removal process and the sugar manufactuing process, look at our Experiments page. 
        
        We formulated a linear optimisation problem using the cost function and the constraints derived above. Using SciPy's `minimize` method
        we solved the problem to find the optimal composition of the inoculant. The result, along with the LD50 values of each component is tabulated. 

    :markdown-it(html plugins=['markdown-it-multimd-table'])
        | Component               | LD50 (Rats, oral) (g/kg) | Optimised Concentration (w/w)|
        | :---------:             | :----------------------: | :--------------------------: |
        | Culture Broth (LB)      | —                        | 95                           |
        | Triton X 100            | 4.19                     | 3.1                          |
        | Carboxymethyl cellulose | 27                       | 0.1                          |
        | Bentonite               | —                        | 1.4                          |
        | Sorbic Acid             | 7.36                     | 0.2                          |
        | Potassium Sorbate       | 4.34                     | 0.2                          |
        [Table 2: Optimal concentration of each component in the inoculant]

    :markdown-it(html)

        Using the VBN approach stated above, we obtain that the viscosity of the inoculant is \\(1.266 cSt \\) (= \\( 1.266 \times 10^{-6} m^2s^{-1}\\)).
        This viscosity now serves as an ansatz and can be plugged into the equation for water transport in xylem tissues and a velocity of transport for the solvent can be obtained.

        The Reynolds number for transport in xylem tissue is 0.05 [Rand, 1983](#citation4) and the xylem diameter is 50 μm [Evans and Morris, 2017](#citation5). The expression for the Reynolds number 
        for a xylem of diameter \\( D \\) and a fluid with flow rate \\( V \\) and viscosity \\( \nu \\) is
        $$ 
            R = \frac{VD}{\nu}
        $$
        
        Plugging in the values, we obtain that the velocity of flow of the inoculant is \\(1.2 \times 10^{-3} m s^{-1} \\). This value is consitent with values in literature [Evans and Morris, 2017](#citation5).
        This proves that our ansatz was correct.  

        Therefore, in this model, we have found the optimal viscosity and composition of our inoculant, and using that as an anstaz, we have proven that the inoculant is capable of being transported through the 
        xylem tissue.  
        
append buttons
    //- mind the quotes and the plus sign
    +buttonLeft("Notebook")
    +buttonRight("Contribution")

//- DO NOT MODIFY THIS LINE AND ANYTHING BEYOND.
prepend citations
    - var citations = [{"authors": "Zwietering, M. H., Jongenburger, I., Rombouts, F. M. & van 't Riet, K. (1990).", "journal": "Applied and environmental microbiology.", "numbers": "56(6), 1875-1881.", "title": "Modeling of the Bacterial Growth Curve.", "type": "article", "year_published": 1990}, {"authors": "Verhulst, Pierre-Fran\u00e7ois. (1838).", "journal": "Correspondance Math\u00e9matique et Physique.", "numbers": "10, 113-121.", "title": "Notice sur la loi que la population poursuit dans son accroissement.", "type": "article", "year_published": 1838}, {"Google_Books_URL": "https://books.google.co.in/books?id=Gsate978w5MC", "authors": "Maples, R. E.", "publisher": "PennWell Books.", "title": "Petroleum Refinery Process Economics.", "type": "book", "year_published": "(2000)."}, {"authors": "Rand, R. H. (1983). ", "doi": "https://doi.org/10.1146/annurev.fl.15.010183.000333", "journal": "Annual Review of Fluid Mechanics", "numbers": "15(1), 29-45. ", "title": "Fluid Mechanics of Green Plants.", "type": "article"}, {"authors": "Evans, M. J., & Morris, R. J. (2017). ", "doi": "https://doi.org/10.1111/tpj.13624", "journal": "The Plant Journal", "numbers": "91(6), 1029-1037. ", "title": "Chemical agents transported by xylem mass flow propagate variation potentials.", "type": "article"}]